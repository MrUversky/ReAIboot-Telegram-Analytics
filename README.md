# ReAIboot Telegram Analytics

Инструмент для анализа популярных постов в Telegram-каналах и генерации идей для проекта "Перепрошивка".

## TL;DR

Собирает топовые посты из Telegram-каналов за последние 7 дней и генерирует сценарии для контента.

## Установка

1. Клонируйте репозиторий
2. Создайте виртуальное окружение: `python -m venv venv`
3. Активируйте окружение: 
   - Windows: `venv\Scripts\activate`
   - macOS/Linux: `source venv/bin/activate`
4. Установите зависимости: `pip install -r requirements.txt`

## Настройка

1. Скопируйте `.env.example` в `.env`
2. Получите `TELEGRAM_API_ID` и `TELEGRAM_API_HASH` на [my.telegram.org](https://my.telegram.org)
3. Заполните эти данные в файле `.env`
4. Опционально добавьте `OPENAI_API_KEY` для генерации сценариев

## Использование

### Первый запуск

```bash
python -m src.main
```

При первом запуске вам будет предложено ввести номер телефона и код подтверждения из Telegram. После этого сессия будет сохранена локально для последующих запусков.

### Параметры командной строки

```bash
python -m src.main --days 7 --top-overall 30 --top-per-channel 5 --limit 2000
```

Доступные опции:
- `--days N` - количество дней для анализа (по умолчанию 7)
- `--top-overall N` - количество лучших постов в общем рейтинге (по умолчанию 30)
- `--top-per-channel N` - количество лучших постов для каждого канала (по умолчанию 5)
- `--limit N` - максимальное количество сообщений для сбора с канала (по умолчанию 2000)Админ 
- `--channels-file PATH` - путь к файлу со списком каналов (по умолчанию channels.txt)
- `--content-plan PATH` - путь к файлу с планом контента (по умолчанию content_plan.yaml)
- `--score-config PATH` - путь к файлу с весами для расчета метрик (по умолчанию score.yaml)
- `--tz TIMEZONE` - часовой пояс (по умолчанию из .env или Asia/Tbilisi)
- `--no-llm` - отключить использование LLM для генерации сценариев

## Результаты

Все выходные файлы сохраняются в директории `out/`:

- `all_messages.csv` - все собранные посты с метриками
- `top_overall.csv` - топ N постов по общему рейтингу
- `top_by_channel.csv` - топ N постов для каждого канала
- `scenarios.md` - сгенерированные сценарии (если включен LLM)

## Настройка весов для рейтинга

Веса для расчета рейтинга можно настроить в файле `score.yaml`:

```yaml
weights:
  reaction_rate: 0.4  # вес для реакций
  reply_rate: 0.3     # вес для комментариев
  forward_rate: 0.2   # вес для пересылок
  view_rate: 0.1      # вес для просмотров
```

## Часто задаваемые вопросы

**Q: Почему количество комментариев (replies) равно 0?**  
A: Комментарии могут быть недоступны, если в канале отключены обсуждения.

**Q: Почему нет ссылки на пост?**  
A: Ссылки доступны только для каналов с публичным username.

**Q: Как увеличить период анализа?**  
A: Используйте параметр `--days`, например `python -m src.main --days 30`

**Q: Как отключить генерацию сценариев через LLM?**  
A: Используйте флаг `--no-llm` или не указывайте OPENAI_API_KEY в файле .env
