# üóÉÔ∏è Migrations - –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–≠—Ç–∞ –ø–∞–ø–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç SQL –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Supabase.

## üìÑ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ

### –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ö–µ–º–∞
- `../supabase_schema.sql` - **–ê–ö–¢–£–ê–õ–¨–ù–ê–Ø** –ø–æ–ª–Ω–∞—è —Å—Ö–µ–º–∞ –ë–î (–≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞)
  - –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –∂–∏–≤–æ–π Supabase –ë–î 2025-09-13
  - –í–∫–ª—é—á–∞–µ—Ç –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã, –ø–æ–ª–∏—Ç–∏–∫–∏ RLS, –∏–Ω–¥–µ–∫—Å—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏
**–°—Ç–∞—Ä—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ —É–¥–∞–ª–µ–Ω—ã** - –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω—ã –≤ –∞–∫—Ç—É–∞–ª—å–Ω—É—é —Å—Ö–µ–º—É.

## üöÄ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π

### –î–ª—è –Ω–æ–≤–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
```sql
-- –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø–æ–ª–Ω—É—é –∞–∫—Ç—É–∞–ª—å–Ω—É—é —Å—Ö–µ–º—É
\i supabase_schema.sql
```

### –î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
- **–ù–ï –ø—Ä–∏–º–µ–Ω—è–π—Ç–µ** `supabase_schema.sql` –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ë–î!
- –î–ª—è –±—É–¥—É—â–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –Ω–æ–≤—ã–µ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏

### ‚ö†Ô∏è –í–∞–∂–Ω–æ:
- `supabase_schema.sql` –æ—Ç—Ä–∞–∂–∞–µ—Ç **—Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ** production –ë–î
- –í—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —É–∂–µ –≤–∫–ª—é—á–µ–Ω—ã –≤ —ç—Ç—É —Å—Ö–µ–º—É
- **–í—Å–µ–≥–¥–∞ –¥–µ–ª–∞–π—Ç–µ –±—ç–∫–∞–ø** –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –ª—é–±—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã

–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–î:

1. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é** –≤ —ç—Ç–æ–π –ø–∞–ø–∫–µ –¥–ª—è –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
2. **–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è** –æ–±–Ω–æ–≤–∏—Ç–µ `supabase_schema.sql` –∫–æ–º–∞–Ω–¥–æ–π:
   ```bash
   # –ß–µ—Ä–µ–∑ MCP Supabase –∏–ª–∏ SQL Editor –ø–æ–ª—É—á–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—É—é —Å—Ö–µ–º—É
   python3 -c "
   import supabase
   # –ü–æ–ª—É—á–∏—Ç—å —Å—Ö–µ–º—É –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª
   "
   ```

## üîß –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–∏–≥—Ä–∞—Ü–∏–π

–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Å—Ö–µ–º—É:

1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π SQL —Ñ–∞–π–ª: `YYYY-MM-DD_description.sql`
2. –î–æ–±–∞–≤—å—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞
3. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ staging –æ–∫—Ä—É–∂–µ–Ω–∏–∏
4. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –≤ production
5. –û–±–Ω–æ–≤–∏—Ç–µ `supabase_schema.sql`

### –®–∞–±–ª–æ–Ω –º–∏–≥—Ä–∞—Ü–∏–∏:
```sql
-- –ú–∏–≥—Ä–∞—Ü–∏—è: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—è –≤ —Ç–∞–±–ª–∏—Ü—É users
-- –î–∞—Ç–∞: 2025-09-13
-- –ê–≤—Ç–æ—Ä: Igor

-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è
ALTER TABLE users ADD COLUMN avatar_url TEXT;

-- –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
CREATE INDEX idx_users_avatar_url ON users(avatar_url);

-- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
COMMENT ON COLUMN users.avatar_url IS 'URL –∞–≤–∞—Ç–∞—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è';
```

## üìä –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –î–∞—Ç–∞ | –ò–∑–º–µ–Ω–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|------|-----------|--------|
| 2025-09-13 | –ü–æ–ª–Ω–∞—è –∞–∫—Ç—É–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ –∏–∑ production | ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞—è |
| –î–æ 2025-09-13 | –°—Ç–∞—Ä—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ | üóëÔ∏è –£–¥–∞–ª–µ–Ω—ã (–≤–∫–ª—é—á–µ–Ω—ã –≤ —Å—Ö–µ–º—É) |

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∏–º–µ—é—Ç Row Level Security (RLS) –ø–æ–ª–∏—Ç–∏–∫–∏
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –º–∏–≥—Ä–∞—Ü–∏–π
- –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ staging –æ–∫—Ä—É–∂–µ–Ω–∏–∏
